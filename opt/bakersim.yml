---
# file: bakersim.yml
#
# author: Philip Lombardi (plombardi@datawire.io)

kubernetes:
  config_path: /home/plombardi/.kube/config

  master_instance_type: t2.small
  node_instance_type: t2.small
  node_count: 5

docker:
  file: docker/bakerscale-dev.dockerfile
  packagecloud_repository: datawire/dev
  packages:
    - data

packagecloud_repository: datawire/development
packages:
  - datawire-common
  - datawire-directory
  - datawire-sherlock
  - datawire-watson

logging:
  level: DEBUG
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

bakerscale:
  image: plombardi89/bs:latest
  teardown:
    - bakerscale_client
    - bakerscale_server
    - directory-rc
  profiles:
    max_load:
      description: increase clients until failure
      initial_services: 1
      initial_clients: 1
      cycles: -1
      cycle_quantum: 60
      tasks:
        - type: spawn.servers
          count: 10
        - type: spawn.clients
          count: 10
    1h_s500_c500:
      description: "50 cycles : 500 services, 500 clients"
      services: 500
      clients: 500
      cycles: 50
      cycle_length: 60s
      tasks:
        - type: kill
          target: service
          percent: 10
        - type:
    s100_c100:
      description: "Infinite - 100 services, 100 clients"
      services: 100
      clients: 100
      churn: 0
      cycles: 10
      cycle_length: 60s
      tasks:
        - type: spawn.service
          args:
            rc: bakerstreet_server
            count: 100
        - type: spawn.client
          args:
            rc: bakerstreet_client
            count: 100
